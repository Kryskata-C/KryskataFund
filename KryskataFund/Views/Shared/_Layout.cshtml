<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - KryskataFund</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/kryskatafund.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/KryskataFund.styles.css" asp-append-version="true" />
</head>
<body>
    <div class="page-wrapper">
        <header class="site-nav">
            <div class="nav-container">
                <div class="nav-left">
                    <a asp-area="" asp-controller="Home" asp-action="Index" class="brand">
                        <div class="brand-icon"></div>
                        <span class="brand-name">KryskataFund</span>
                    </a>
                </div>

                <nav class="nav-center">
                    <a asp-controller="Home" asp-action="Index" class="nav-item nav-item--active">Discover</a>
                    <a href="#" class="nav-item">Categories</a>
                    <a href="#" class="nav-item">Success Stories</a>
                    <a href="#" class="nav-item">How it works</a>
                </nav>

                <div class="nav-right">
                    @if (Context.Session.GetString("IsSignedIn") != "true")
                    {
                        <a asp-controller="Account" asp-action="SignIn" class="btn-signin">Sign in</a>
                    }
                    <a asp-controller="Funds" asp-action="Create" class="btn-create">
                        <span>+</span> Create Fund
                    </a>
                    @if (Context.Session.GetString("IsSignedIn") == "true")
                    {
                        <div class="profile-buddy-container" id="buddyContainer">
                            <div class="profile-buddy" id="profileBuddy">
                                <!-- Cute blob character -->
                                <div class="buddy-body">
                                    <div class="buddy-face">
                                        <div class="buddy-eyes">
                                            <div class="buddy-eye left">
                                                <div class="buddy-pupil"></div>
                                            </div>
                                            <div class="buddy-eye right">
                                                <div class="buddy-pupil"></div>
                                            </div>
                                        </div>
                                        <div class="buddy-mouth"></div>
                                        <div class="buddy-blush left"></div>
                                        <div class="buddy-blush right"></div>
                                    </div>
                                </div>
                                <div class="buddy-glow"></div>
                            </div>
                            <!-- Portal/vortex effect -->
                            <div class="buddy-portal" id="buddyPortal">
                                <div class="portal-ring"></div>
                                <div class="portal-ring"></div>
                                <div class="portal-ring"></div>
                                <div class="portal-core"></div>
                            </div>
                            <!-- Particles for sucking effect -->
                            <div class="buddy-particles" id="buddyParticles"></div>
                        </div>
                        <script>
                            document.getElementById('profileBuddy').addEventListener('click', function(e) {
                                e.stopPropagation();
                                const container = document.getElementById('buddyContainer');
                                const buddy = document.getElementById('profileBuddy');
                                const portal = document.getElementById('buddyPortal');
                                const particles = document.getElementById('buddyParticles');

                                // Create particles
                                for (let i = 0; i < 12; i++) {
                                    const particle = document.createElement('div');
                                    particle.className = 'buddy-particle';
                                    particle.style.setProperty('--angle', (i * 30) + 'deg');
                                    particle.style.setProperty('--delay', (i * 0.05) + 's');
                                    particles.appendChild(particle);
                                }

                                // Activate portal and suck-in animation
                                portal.classList.add('active');
                                buddy.classList.add('sucking-in');

                                // Navigate after animation
                                setTimeout(() => {
                                    sessionStorage.setItem('buddyEmerging', 'true');
                                    window.location.href = '/Account/Profile';
                                }, 800);
                            });
                        </script>
                    }
                </div>
            </div>
        </header>

        <main class="main-content">
            @RenderBody()
        </main>

        <footer class="site-footer">
            <div class="footer-content">
                &copy; 2025 KryskataFund - <a asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
            </div>
        </footer>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
